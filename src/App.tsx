import { useState, useEffect } from 'react'; import { Toaster } from "@/components/ui/toaster"; import { Toaster as Sonner } from "@/components/ui/sonner"; import { TooltipProvider } from "@/components/ui/tooltip"; import { QueryClient, QueryClientProvider } from "@tanstack/react-query"; import { BrowserRouter, Routes, Route, Navigate } from "react-router-dom"; import { MainLayout } from "./components/layout/MainLayout"; import { Scale, Lock, Loader2, Facebook } from 'lucide-react'; import { toast } from 'sonner'; import Dashboard from "./pages/Dashboard"; import Clients from "./pages/Clients"; import Cases from "./pages/Cases"; import Sessions from "./pages/Sessions"; import Finance from "./pages/Finance"; import Documents from "./pages/Documents"; import Alerts from "./pages/Alerts"; import Users from "./pages/Users"; import Reports from "./pages/Reports"; import Settings from "./pages/Settings"; import NotFound from "./pages/NotFound"; const queryClient = new QueryClient(); const App = () => { const [user, setUser] = useState<any>(null); const [loading, setLoading] = useState(true); const [form, setForm] = useState({ n: '', p: '' }); useEffect(() => { const s = localStorage.getItem('current_lawyer_user'); if (s) setUser(JSON.parse(s)); if (!localStorage.getItem('lawyer_users')) { localStorage.setItem('lawyer_users', JSON.stringify([{ id: 1, name: 'admin', role: 'admin', password: '123', status: 'active' }])); } setTimeout(() => setLoading(false), 300); }, []); const hL = (e: any) => { e.preventDefault(); const all = JSON.parse(localStorage.getItem('lawyer_users') || '[]'); const f = all.find((u: any) => u.name.trim().toLowerCase() === form.n.trim().toLowerCase() && (u.password?.toString() || '123') === form.p.toString()); if (f) { if (f.status === 'inactive') return toast.error('الحساب معطل'); setUser(f); localStorage.setItem('current_lawyer_user', JSON.stringify(f)); toast.success('تم الدخول'); } else toast.error('بيانات خاطئة'); }; if (loading) return ( <div className="min-h-screen bg-white flex items-center justify-center font-arabic" dir="rtl"> <div className="text-center space-y-4"> <div className="w-20 h-20 bg-amber-500 rounded-3xl flex items-center justify-center mx-auto shadow-2xl animate-bounce"><Scale className="text-white w-10 h-10" /></div> <div className="flex items-center gap-2 text-slate-400 font-black text-sm"><Loader2 className="w-4 h-4 animate-spin" /> جاري تحميل المكتب...</div> </div> </div> ); if (!user) return ( <div className="min-h-screen bg-slate-900 flex items-center justify-center p-4 font-arabic" dir="rtl"> <Sonner position="top-center" /> <div className="bg-white w-full max-w-md rounded-3xl p-8 shadow-2xl space-y-6 text-center border-t-4 border-amber-500 animate-in fade-in zoom-in duration-300"> <div className="w-16 h-16 bg-amber-500 rounded-2xl flex items-center justify-center mx-auto shadow-lg"><Scale className="text-white w-8 h-8" /></div> <div className="space-y-1"> <h1 className="text-2xl font-black text-slate-800">نظام المكتب الذكي</h1> <p className="text-slate-400 text-[10px] font-bold">يرجى إدخال بيانات الاعتماد للوصول</p> </div> <form onSubmit={hL} className="space-y-4"> <div className="text-right"> <label className="text-[10px] font-bold text-slate-500 mr-1">اسم المستخدم</label> <input required className="w-full p-3 border-2 rounded-xl text-right font-bold outline-none focus:border-amber-500 transition-all text-slate-800" placeholder="admin" onChange={(e) => setForm({...form, n: e.target.value})} /> </div> <div className="text-right"> <label className="text-[10px] font-bold text-slate-500 mr-1">كلمة المرور</label> <input type="password" required className="w-full p-3 border-2 rounded-xl text-right font-bold outline-none focus:border-amber-500 transition-all text-slate-800" placeholder="••••" onChange={(e) => setForm({...form, p: e.target.value})} /> </div> <button type="submit" className="w-full bg-slate-800 text-white py-4 rounded-xl font-bold flex items-center justify-center gap-2 hover:bg-slate-700 shadow-lg active:scale-95 transition-all"><Lock className="w-4 h-4 text-amber-500" /> تسجيل الدخول</button> </form> <div className="pt-4 border-t border-slate-50 space-y-3"> <p className="text-[11px] text-slate-500 font-black">إعداد وبرمجة: مجدي خلفه</p> <a href="https://www.facebook.com/magdy.khelfa" target="_blank" rel="noreferrer" className="inline-flex items-center gap-2 px-4 py-2 bg-[#1877F2]/10 text-[#1877F2] rounded-full text-[10px] font-bold hover:bg-[#1877F2] hover:text-white transition-all transform hover:scale-110"> <Facebook className="w-4 h-4" /> تواصل معنا عبر فيسبوك </a> </div> </div> </div> ); return ( <QueryClientProvider client={queryClient}> <TooltipProvider> <Toaster /> <Sonner position="top-left" /> <BrowserRouter basename="/mohamy"> <MainLayout user={user}> <Routes> <Route path="/" element={<Dashboard />} /> <Route path="/clients" element={<Clients />} /> <Route path="/cases" element={user.role !== 'secretary' ? <Cases /> : <Navigate to="/" />} /> <Route path="/sessions" element={<Sessions />} /> <Route path="/finance" element={user.role === 'admin' ? <Finance /> : <Navigate to="/" />} /> <Route path="/documents" element={<Documents />} /> <Route path="/alerts" element={<Alerts />} /> <Route path="/users" element={user.role === 'admin' ? <Users /> : <Navigate to="/" />} /> <Route path="/reports" element={user.role === 'admin' ? <Reports /> : <Navigate to="/" />} /> <Route path="/settings" element={user.role === 'admin' ? <Settings /> : <Navigate to="/" />} /> <Route path="*" element={<NotFound />} /> </Routes> </MainLayout> </BrowserRouter> </TooltipProvider> </QueryClientProvider> ); }; export default App;