import { Calendar, Clock, MapPin, User } from 'lucide-react'; import { useState, useEffect } from 'react'; export function UpcomingSessions() { const [sessions, setSessions] = useState<any[]>([]); useEffect(() => { const cases = JSON.parse(localStorage.getItem('lawyer_cases') || '[]'); const settings = JSON.parse(localStorage.getItem('office_settings') || '{"n":{"days":1}}'); const threshold = settings.n?.days || 1; const today = new Date(); today.setHours(0, 0, 0, 0); const filtered = cases.filter((c: any) => { if (!c.nextSession) return false; const sDate = new Date(c.nextSession); const diff = Math.ceil((sDate.getTime() - today.getTime()) / (86400000)); return diff >= 0 && diff <= threshold; }).map((c: any) => { const sDate = new Date(c.nextSession); const diff = Math.ceil((sDate.getTime() - today.getTime()) / (86400000)); return { ...c, status: diff === 0 ? 'today' : diff === 1 ? 'tomorrow' : 'upcoming' }; }).sort((a: any, b: any) => new Date(a.nextSession).getTime() - new Date(b.nextSession).getTime()); setSessions(filtered); }, []); const statusStyles: any = { today: 'bg-red-100 text-red-700 border-red-200', tomorrow: 'bg-amber-100 text-amber-700 border-amber-200', upcoming: 'bg-blue-100 text-blue-700 border-blue-200' }; const statusLabels: any = { today: 'اليوم', tomorrow: 'غداً', upcoming: 'قريباً' }; return ( <div className="bg-card rounded-xl shadow-card overflow-hidden border"> <div className="p-6 border-b border-border flex items-center justify-between bg-slate-50/50"> <h2 className="text-lg font-bold text-foreground flex items-center gap-2"><Calendar className="w-5 h-5 text-amber-500" /> الجلسات القادمة ({sessions.length})</h2> <button onClick={() => window.location.href='/mohamy/sessions'} className="text-xs font-bold text-primary hover:underline">عرض الكل</button> </div> <div className="divide-y divide-border max-h-[400px] overflow-y-auto"> {sessions.length === 0 ? ( <div className="p-10 text-center text-muted-foreground font-bold">لا توجد جلسات قادمة خلال الفترة المحددة</div> ) : ( sessions.map((session, idx) => ( <div key={idx} className="p-4 hover:bg-muted/30 transition-colors text-right" dir="rtl"> <div className="flex items-start justify-between"> <div className="space-y-2"> <div className="flex items-center gap-2"> <span className="font-bold text-slate-800">قضية: {session.caseNumber || 'بدون رقم'}</span> <span className={`px-2 py-0.5 rounded text-[10px] border font-bold ${statusStyles[session.status]}`}>{statusLabels[session.status]}</span> </div> <div className="flex items-center gap-4 text-xs text-muted-foreground font-bold"> <span className="flex items-center gap-1"><User className="w-3 h-3 text-amber-500" /> {session.clientName || 'غير محدد'}</span> <span className="flex items-center gap-1"><MapPin className="w-3 h-3 text-amber-500" /> {session.court || 'غير محدد'}</span> </div> </div> <div className="text-left font-bold"> <p className="text-xs text-slate-700">{session.nextSession}</p> <p className="text-[10px] text-muted-foreground flex items-center justify-end gap-1"><Clock className="w-3 h-3" /> {session.sessionTime || '--:--'}</p> </div> </div> </div> )) )} </div> </div> ); }