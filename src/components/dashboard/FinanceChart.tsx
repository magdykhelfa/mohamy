import { useState, useEffect } from 'react'; import { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } from 'recharts'; import { DollarSign, TrendingUp } from 'lucide-react'; export function FinanceChart() { const [data, setData] = useState<any[]>([{ name: 'المحصل', value: 0 }, { name: 'المتبقي', value: 0 }]); useEffect(() => { try { const trans = JSON.parse(localStorage.getItem('lawyer_transactions') || '[]'); const cases = JSON.parse(localStorage.getItem('lawyer_cases') || '[]'); const paid = trans.reduce((acc: number, t: any) => acc + (Number(t.amount || 0)), 0); const rem = trans.reduce((acc: number, t: any) => acc + (Number(t.remaining || 0)), 0) || cases.reduce((acc: number, c: any) => acc + (Number(c.remainingAmount || 0)), 0); setData([{ name: 'المحصل', value: paid }, { name: 'المتبقي', value: rem }]); } catch (e) { console.error(e); } }, []); return ( <div className="bg-white p-6 rounded-2xl border shadow-sm h-full font-arabic" dir="rtl"> <div className="flex items-center justify-between mb-6"> <div className="flex items-center gap-2"><div className="p-2 bg-amber-50 rounded-lg text-amber-600"><DollarSign className="w-5 h-5" /></div><h2 className="font-black text-slate-800 text-sm">التحليل المالي</h2></div> <div className="flex items-center gap-1 text-green-600 font-bold text-[10px]"><TrendingUp className="w-4 h-4" /> <span>مباشر</span></div> </div> <div className="h-[200px] w-full" dir="ltr"><ResponsiveContainer width="100%" height="100%"><BarChart data={data}><CartesianGrid strokeDasharray="3 3" vertical={false} stroke="#f1f5f9" /><XAxis dataKey="name" axisLine={false} tickLine={false} tick={{ fontSize: 10, fontWeight: 'bold', fill: '#64748b' }} /><YAxis hide /><Tooltip cursor={{ fill: '#f8fafc' }} contentStyle={{ borderRadius: '12px', border: 'none' }} /><Bar dataKey="value" fill="#f59e0b" radius={[4, 4, 0, 0]} barSize={40} /></BarChart></ResponsiveContainer></div> <div className="grid grid-cols-2 gap-2 mt-6"><div className="p-3 bg-slate-50 rounded-xl border-r-2 border-amber-500 text-right"><p className="text-[10px] text-slate-500 font-bold">المحصل</p><p className="text-sm font-black text-slate-800">{data[0].value.toLocaleString()} <span className="text-[8px]">ج.م</span></p></div> <div className="p-3 bg-slate-50 rounded-xl border-r-2 border-slate-800 text-right"><p className="text-[10px] text-slate-500 font-bold">المتبقي</p><p className="text-sm font-black text-slate-800">{data[1].value.toLocaleString()} <span className="text-[8px]">ج.م</span></p></div></div> </div> ); }